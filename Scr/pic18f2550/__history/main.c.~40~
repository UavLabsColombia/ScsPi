// Convertidor de Analogo a Digital
#include <18F2550.h> 
#fuses xt,nowdt,noprotect,put,CPUDIV1

// Numero de bits a utilizar sobre el convertidor analogo
#device adc = 10
#use delay (internal=8000000)
#use rs232(baud=9600, bits=8, parity=N, xmit=PIN_C6, RCV=PIN_C7 )


//incluye laa libreria modificada para majear la lcd en por el puerto D 


//Definicion para los puertos
#use fast_io(b)
#use fast_io(a)

// Variables Globales
//calculo de la resulucion en la salida  
float resolucion = (float)5/(float)1023;

// Dependiendo del tipo de dato, se puede variar la resolucion, para mostrar datos como temperatura,
// resolucion2 permite expresar la salida del dato de 0 a 200
float resolucion2 = 200.0f / 1023.0f;

// Se define el puerto ADC a utilizar y sus pines. 
void defport() 
{   // Define el puerto D como salida
    set_tris_b(0x00);
    set_tris_a(0b00000001);
    // Define el puerto A como entrada 
    // Define como entradas analogas los puertos AN0 to AN3
    SETUP_ADC_PORTS(AN0);
    // Define el relog interno para el uso del ADC
    SETUP_ADC(ADC_CLOCK_INTERNAL);
}
// Metodo cread para pintar la lCD

void main() {

      defport();  
      int16 Valor=0;
      float ValorADC=0;
      SET_ADC_CHANNEL(0);
      
      
      
      while(true){
         // Delay para esperar la lectura
         delay_ms(500);
         // Lee el puerto Analogo
         Valor = READ_ADC();
         //output_toggle(PIN_B1);         
         ValorADC = resolucion * (float) Valor;
         
         if(ValorADC > 1.0f)
         {
         
            output_high(PIN_B1);
            delay_ms(500);
         }
         else
         {
            output_low(PIN_B1);
            delay_ms(500);
         }
      }
    
}
